<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>气象在线-空气质量</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/highcharts.css" />
    <link href="css/radialindicator.css"  rel="stylesheet" type="text/css" />
    <script src="js/jquery.min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ecN0P1oLSgL1MkjLu3PKO6FlsFYgBu3R"></script>
    <script type="text/javascript" src="js/highcharts.js" ></script>
    <script src="js/radialindicator.js"></script>
    <script src="js/demo.js"></script>
</head>
<body>
	<nav>
		<a class="le" href="#">
			<img src="images/le-jian.png">
		</a>
		<h2>空气质量</h2>
		<a class="ri" href="#">
			<img src="images/share.png">
		</a>
	</nav>
	<div class="main">
		<div class="main-air">
			<h3>北京</h3>
			<h4>中国天气  13:10 发布</h4>
			<div class="prg-cont rad-prg" id="indicatorContainer2">
				<div class="box-zhi">
					<span class="b-titles">
						空气质量指数
					</span>
			    	<span id="shuzhi" class="shuzhis">65</span>
			    	<span class="ylc">
			    		优
			    	</span>
			    	<div class="kedu">
			    		<b class="bg-01">0</b>
			    		<b class="bg-02">50</b>
			    		<b class="bg-03">100</b>
			    		<b class="bg-04">150</b>
			    		<b class="bg-05">200</b>
			    		<b class="bg-06">300</b>
			    		<b class="bg-07">500</b>
			    	</div>	
				</div>
		  </div>
		  <div class="xinxi">
			温馨提示：空气好，可以外出活动，呼吸新鲜空气，拥抱大自然！
		</div>
		<div class="looks">
			<a href="#">查看全国排行</a>
		</div>
		</div>
		<!--检测数据-->
		<div class="shuju">
			<div class="title">
				<h2>检测数据</h2>
				<span>TEST DATA</span>
				<span class="ri">
					单位:浓度μg/m3 CO为mg/m3
				</span>
			</div>
			<div class="shuju-text">
				<ul>
					<li>
						<div class="shuju-le" id="pm10">
							35
						</div>
						<div class="shuju-ri">
							<b>PM10</b>
							<span>可吸入颗粒物</span>
						</div>
					</li>
					<li>
						<div class="shuju-le" id="pm25">
							80
						</div>
						<div class="shuju-ri">
							<b>PM2.5</b>
							<span>入肺颗粒物</span>
						</div>
					</li>
					<li>
						<div class="shuju-le" id="NO2">
							48
						</div>
						<div class="shuju-ri">
							<b>NO<sub>2</sub></b>
							<span>二氧化氮</span>
						</div>
					</li>
					<li>
						<div class="shuju-le" id="SO2">
							2
						</div>
						<div class="shuju-ri">
							<b>SO<sub>2</sub></b>
							<span>二氧化硫</span>
						</div>
					</li>
					<li>
						<div class="shuju-le" id="co">
							0.5
						</div>
						<div class="shuju-ri">
							<b>CO</b>
							<span>一氧化碳</span>
						</div>
					</li>
					<li>
						<div class="shuju-le" id="o3">
							29
						</div>
						<div class="shuju-ri">
							<b>o<sub>3</sub></b>
							<span>臭氧</span>
						</div>
					</li>
				</ul>
			</div>
		</div>
		<!--空气质量报告/空气质量实况-->
		<div class="baogao">
			<div class="b-title">
				<span class="on">空气质量报告</span>
				<span>空气质量实况</span>
			</div>
			<div class="b-zhi">
				<ul>
					<li class="zbg">
						<div class="btn">
							<a class="on" href="#">AQI</a>
							<a href="#">PM10</a>
							<a href="#">PM2.5</a>
						</div>
						<div id="container01" style="background: url(images/airf.jpg) no-repeat left top;width:90%; height:160px; margin: 0 auto; position: relative;">
						</div>
						<div class="kulian">
							<img src="images/kulian.jpg">
						</div>
						<div class="xiaolian">
							<img src="images/xiaolian.jpg">
						</div>
					</li>
					<li class="zb" style="display: none;">
						<div class="zb-t">
							<a href="">今天</a>
							<a href="">星期三</a>
							<a href="">星期四</a>
						</div>
						<div id="container" style="width:90%; height:220px; margin: 0 auto; position: relative;"></div>
						<div class="kulian kulian2">
							<img src="images/kulian2.jpg">
						</div>
						<div class="xiaolian xiaolian2">
							<img src="images/zhong.jpg">
						</div>
						<div class="xl">
							<img src="images/xiaolian2.jpg">
						</div>
					</li>
				</ul>
			</div>
		</div>
		<script>
			$(function(){
				$(".b-title span").click(function(){
					$(this).addClass("on");
					$(this).siblings().removeClass("on");
					var x=$(".b-title span").index(this);
					$(".b-zhi ul li").hide();
					$(".b-zhi ul li").eq(x).show();
				})
			})
		</script>
		<!--地图-->
		<div class="map">
			<div class="title">
				<h2>城市监测点</h2>
				<span>CITY MONITORING</span>
				<a href="#">查看全国环境检测</a>
			</div>
			<div id="map">
				
			</div>
			<div class="more">
				<a href="#">查看全部</a>
			</div>
			<div class="line"></div>
		</div>
	</div>
	<footer>
		<div class="logo">
			<a href="#"><img src="images/logo.jpg"></a>
		</div>
		<div class="lianxi">
			<a href="">联系我们</a>
			<a href="">意见反馈</a>
			<a href="">下载APP</a>
		</div>
		<div class="bei">
			<p>客服热线：400-6000-121</p>
			<p>京公网安备1104 1400134号</p>
		</div>
	</footer>
	 <script type="text/javascript">
	    //创建和初始化地图函数：
	    function initMap(){
	      createMap();//创建地图
	      setMapEvent();//设置地图事件
	      addMapControl();//向地图添加控件
	      addMapOverlay();//向地图添加覆盖物
	    }
	    function createMap(){ 
	      map = new BMap.Map("map"); 
	      map.centerAndZoom(new BMap.Point(116.303576,39.952518),15);
	    }
	    function setMapEvent(){
	      map.enableScrollWheelZoom();
	      map.enableKeyboard();
	      map.enableDragging();
	      map.enableDoubleClickZoom()
	    }
	    function addClickHandler(target,window){
	      target.addEventListener("click",function(){
	        target.openInfoWindow(window);
	      });
	    }
	    function addMapOverlay(){
	    }
	    //向地图添加控件
	    function addMapControl(){
	      var scaleControl = new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});
	      scaleControl.setUnit(BMAP_UNIT_IMPERIAL);
	      map.addControl(scaleControl);
	      var navControl = new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
	      map.addControl(navControl);
	      var overviewControl = new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:true});
	      map.addControl(overviewControl);
	    }
	    var map;
	      initMap();
	 </script>
	 <script type="text/javascript">
		var img1DateArr = [];
		var img1DataArr = [];
		
		var img2dataObject = [];
		var img2DataArr = [];
		$(function () {
			$.getJSON('./data.json', function(data) {
			console.log(data);
				//空气质量环
				var y;
				var x  = parseInt(data.airQuality);
				if(x<200){
					$(".ylc").text("差");
					y = x/1.111;
				}else if(x<=300){
					$(".ylc").text("优");
					y = (x-200)/2.222+180;
				}else if(x<=500){
					$(".ylc").text("优");
					y = (x-300)/4.444+225;
				}else{
					$(".ylc").text("优");
					y = 270;
				}
				 $('#indicatorContainer2').radialIndicator({	
			       fontColor:'rgba(0,0,0,0)',
			       barColor: '#56d9ff',
			        barWidth:10,
			        initValue:parseInt(y),
			        roundCorner: true,
			        percentage: false,
			        radius:100,
			        fontSize:1,
			        minValue:0,
			        maxValue:360,
			        roundCorner:true,
			        
				 });
				$("#shuzhi").text(data.airQuality);
				//PM10 PM2.5 No2....赋值
				$("#pm10").text(data.pm10);
				$("#pm25").text(data.pm25);
				$("#NO2").text(data.NO2);
				$("#SO2").text(data.SO2);
				$("#co").text(data.co);
				$("#o3").text(data.o3);
				//highcharts 数据准备
				for(var step in data.aqi) {
					img1DateArr.push( parseInt(step) );
					img1DataArr.push( data.aqi[step] );
				}
				for(var step in data.airqualitys) {
					var tmpObject  = {};
					tmpObject['name'] = step+'';
					tmpObject['y'] = parseFloat(data.airqualitys[step]);
					tmpObject['drilldown'] = '';
					img2dataObject.push(tmpObject);
				}
				
				// imgContainer01(img1DataArr, img1DateArr);
				// imgContainer(img2dataObject);
			});
		});

		function imgContainer01(img1DataArr, img1DateArr) {
			Highcharts.chart('container01', {
		        chart: {
		            type: 'spline'
		        },
		        title: {
		            text: ''
		        },
		        subtitle: {
		            text: ''
		        },
		        xAxis: {
		            categories: img1DateArr
		        },
		        yAxis: {
		            title: {
		                text: ''
		            },
		            labels: {
		                formatter: function () {
		                    return this.value + '°';
		                }
		            }
		        },
		        tooltip: {
		            crosshairs: true,
		            shared: true
		        },
		        plotOptions: {
		            spline: {
		                marker: {
		                    radius: 4,
		                    lineColor: '#666666',
		                    lineWidth: 1
		                }
		            }
		        },
		        series: [{
		            name: 'Tokyo',
		            marker: {
		                symbol: 'square'
		            },
		            data: img1DataArr
		
		        }]
		    });
		}

		function imgContainer(img2dataObject) {
			// Create the chart
		    Highcharts.chart('container', {
		        chart: {
		            type: 'column'
		        },
		        title: {
		            text: ''
		        },
		        subtitle: {
		            text: ''
		        },
		        xAxis: {
		            type: 'category'
		        },
		        yAxis: {
		            title: {
		                text: ''
		            }
		        },
		        legend: {
		            enabled: false
		        },
		        plotOptions: {
		            series: {
		                borderWidth: 0,
		                dataLabels: {
		                    enabled: true,
		                    format: '{point.y:.1f}%'
		                }
		            }
		        },
		        tooltip: {
		            headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
		            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'
		        },
		        series: [{
		            name: 'Brands',
		            colorByPoint: true,
		            data: img2dataObject
		        }],
		        drilldown: {
		            series: [{
		                name: 'Microsoft Internet Explorer',
		                id: 'Microsoft Internet Explorer',
		                data: [
		                    [
		                        'v11.0',
		                        24.13
		                    ],
		                    [
		                        'v8.0',
		                        17.2
		                    ],
		                    [
		                        'v9.0',
		                        8.11
		                    ],
		                    [
		                        'v10.0',
		                        5.33
		                    ],
		                    [
		                        'v6.0',
		                        1.06
		                    ],
		                    [
		                        'v7.0',
		                        0.5
		                    ]
		                ]
		            }, {
		                name: 'Chrome',
		                id: 'Chrome',
		                data: [
		                    [
		                        'v40.0',
		                        5
		                    ],
		                    [
		                        'v41.0',
		                        4.32
		                    ],
		                    [
		                        'v42.0',
		                        3.68
		                    ],
		                    [
		                        'v39.0',
		                        2.96
		                    ],
		                    [
		                        'v36.0',
		                        2.53
		                    ],
		                    [
		                        'v43.0',
		                        1.45
		                    ],
		                    [
		                        'v31.0',
		                        1.24
		                    ],
		                    [
		                        'v35.0',
		                        0.85
		                    ],
		                    [
		                        'v38.0',
		                        0.6
		                    ],
		                    [
		                        'v32.0',
		                        0.55
		                    ],
		                    [
		                        'v37.0',
		                        0.38
		                    ],
		                    [
		                        'v33.0',
		                        0.19
		                    ],
		                    [
		                        'v34.0',
		                        0.14
		                    ],
		                    [
		                        'v30.0',
		                        0.14
		                    ]
		                ]
		            }, {
		                name: 'Firefox',
		                id: 'Firefox',
		                data: [
		                    [
		                        'v35',
		                        2.76
		                    ],
		                    [
		                        'v36',
		                        2.32
		                    ],
		                    [
		                        'v37',
		                        2.31
		                    ],
		                    [
		                        'v34',
		                        1.27
		                    ],
		                    [
		                        'v38',
		                        1.02
		                    ],
		                    [
		                        'v31',
		                        0.33
		                    ],
		                    [
		                        'v33',
		                        0.22
		                    ],
		                    [
		                        'v32',
		                        0.15
		                    ]
		                ]
		            }, {
		                name: 'Safari',
		                id: 'Safari',
		                data: [
		                    [
		                        'v8.0',
		                        2.56
		                    ],
		                    [
		                        'v7.1',
		                        0.77
		                    ],
		                    [
		                        'v5.1',
		                        0.42
		                    ],
		                    [
		                        'v5.0',
		                        0.3
		                    ],
		                    [
		                        'v6.1',
		                        0.29
		                    ],
		                    [
		                        'v7.0',
		                        0.26
		                    ],
		                    [
		                        'v6.2',
		                        0.17
		                    ]
		                ]
		            }, {
		                name: 'Opera',
		                id: 'Opera',
		                data: [
		                    [
		                        'v12.x',
		                        0.34
		                    ],
		                    [
		                        'v28',
		                        0.24
		                    ],
		                    [
		                        'v27',
		                        0.17
		                    ],
		                    [
		                        'v29',
		                        0.16
		                    ]
		                ]
		            }]
		        }
		    });
		}
</script>

</body>
</html>